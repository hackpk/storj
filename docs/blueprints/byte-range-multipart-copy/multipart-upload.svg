<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1191px" preserveAspectRatio="none" style="width:1036px;height:1191px;background:#FFFFFF;" version="1.1" viewBox="0 0 1036 1191" width="1036px" zoomAndPan="magnify"><defs/><g><rect height="601.9922" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1000.5" x="10" y="286.3594"/><rect height="373.7969" style="stroke:#000000;stroke-width:1.5;fill:none;" width="606.5" x="394" y="449.2891"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="55" x2="55" y1="40.2969" y2="1152.6797"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="440" x2="440" y1="40.2969" y2="1152.6797"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="617.5" x2="617.5" y1="40.2969" y2="1152.6797"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="829.5" x2="829.5" y1="40.2969" y2="1152.6797"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="931.5" x2="931.5" y1="40.2969" y2="1152.6797"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="20" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="27" y="28.9951">S3Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="20" y="1151.6797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="27" y="1171.6748">S3Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="404" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="411" y="28.9951">Gateway</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="404" y="1151.6797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="411" y="1171.6748">Gateway</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="589.5" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="596.5" y="28.9951">Uplink</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="589.5" y="1151.6797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="596.5" y="1171.6748">Uplink</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="795.5" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="802.5" y="28.9951">Satellite</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="795.5" y="1151.6797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="802.5" y="1171.6748">Satellite</text><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="113" x="877.5" y="5"/><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="113" x="873.5" y="9"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="880.5" y="28.9951">StorageNodes</text><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="113" x="877.5" y="1151.6797"/><rect fill="#E2E2F0" height="30.2969" style="stroke:#181818;stroke-width:0.5;" width="113" x="873.5" y="1155.6797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="880.5" y="1175.6748">StorageNodes</text><polygon fill="#181818" points="428.5,67.4297,438.5,71.4297,428.5,75.4297,432.5,71.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="55.5" x2="434.5" y1="71.4297" y2="71.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="62.5" y="66.3638">PUT /bucket/dest?uploads</text><polygon fill="#181818" points="605.5,114.6953,615.5,118.6953,605.5,122.6953,609.5,118.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="440.5" x2="611.5" y1="118.6953" y2="118.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="447.5" y="113.6294">BeginUpload (multipart)</text><path d="M368,84.4297 L368,139.4297 L435,139.4297 L435,94.4297 L425,84.4297 L368,84.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M425,84.4297 L425,94.4297 L435,94.4297 L425,84.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="374" y="101.4966">Bucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="374" y="116.6294">Key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="374" y="131.7622">Expires</text><polygon fill="#181818" points="817.5,161.9609,827.5,165.9609,817.5,169.9609,821.5,165.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="617.5" x2="823.5" y1="165.9609" y2="165.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="624.5" y="160.895">BeginObjectRequest</text><polygon fill="#181818" points="628.5,194.0938,618.5,198.0938,628.5,202.0938,624.5,198.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="622.5" x2="828.5" y1="198.0938" y2="198.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="634.5" y="193.0278">BeginObjectResponse</text><path d="M834,178.9609 L834,203.9609 L916,203.9609 L916,188.9609 L906,178.9609 L834,178.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M906,178.9609 L906,188.9609 L916,188.9609 L906,178.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="840" y="196.0278">StreamID</text><polygon fill="#181818" points="451.5,229.2266,441.5,233.2266,451.5,237.2266,447.5,233.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="445.5" x2="616.5" y1="233.2266" y2="233.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="457.5" y="228.1606">BeginUpload return</text><path d="M622,214.0938 L622,239.0938 L704,239.0938 L704,224.0938 L694,214.0938 L622,214.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M694,214.0938 L694,224.0938 L704,224.0938 L694,214.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="628" y="231.1606">StreamID</text><polygon fill="#181818" points="66.5,264.3594,56.5,268.3594,66.5,272.3594,62.5,268.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="60.5" x2="439.5" y1="268.3594" y2="268.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="72.5" y="263.2935">200 response</text><path d="M445,249.2266 L445,274.2266 L552,274.2266 L552,259.2266 L542,249.2266 L445,249.2266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M542,249.2266 L542,259.2266 L552,259.2266 L542,249.2266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="451" y="266.2935">&lt;UploadId /&gt;</text><path d="M10,286.3594 L194,286.3594 L194,293.4922 L184,303.4922 L10,303.4922 L10,286.3594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="601.9922" style="stroke:#000000;stroke-width:1.5;" width="1000.5" x="10" y="286.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="139" x="25" y="299.4263">loop for every part</text><polygon fill="#181818" points="428.5,320.625,438.5,324.625,428.5,328.625,432.5,324.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="55.5" x2="434.5" y1="324.625" y2="324.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="361" x="62.5" y="319.5591">PUT /bucket/dest?partNumber=1&amp;uploadId=7tKsLOJgNs</text><polygon fill="#181818" points="605.5,375.457,615.5,379.457,605.5,383.457,609.5,379.457" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="440.5" x2="611.5" y1="379.457" y2="379.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="447.5" y="374.3911">UploadPart</text><path d="M336,337.625 L336,407.625 L435,407.625 L435,347.625 L425,337.625 L336,337.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M425,337.625 L425,347.625 L435,347.625 L425,337.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="342" y="354.6919">Bucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="342" y="369.8247">Key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="342" y="384.9575">UploadID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="342" y="400.0903">PartNumber</text><polygon fill="#181818" points="605.5,430.2891,615.5,434.2891,605.5,438.2891,609.5,434.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="440.5" x2="611.5" y1="434.2891" y2="434.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="447.5" y="429.2231">UploadPart.write</text><path d="M394,449.2891 L612,449.2891 L612,456.4219 L602,466.4219 L394,466.4219 L394,449.2891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="373.7969" style="stroke:#000000;stroke-width:1.5;" width="606.5" x="394" y="449.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="173" x="409" y="462.356">loop for every segment</text><polygon fill="#181818" points="817.5,494.1211,827.5,498.1211,817.5,502.1211,821.5,498.1211" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="617.5" x2="823.5" y1="498.1211" y2="498.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="624.5" y="493.0552">SegmentBeginRequest</text><path d="M530,471.4219 L530,511.4219 L612,511.4219 L612,481.4219 L602,471.4219 L530,471.4219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M602,471.4219 L602,481.4219 L612,481.4219 L602,471.4219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="536" y="488.4888">StreamID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="536" y="503.6216">Position</text><polygon fill="#181818" points="628.5,551.9531,618.5,555.9531,628.5,559.9531,624.5,555.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="622.5" x2="828.5" y1="555.9531" y2="555.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="634.5" y="550.8872">SegmentBeginResponse</text><path d="M834,521.6875 L834,576.6875 L983,576.6875 L983,531.6875 L973,521.6875 L834,521.6875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M973,521.6875 L973,531.6875 L983,531.6875 L973,521.6875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="840" y="538.7544">SegmentID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="840" y="553.8872">OrderLimits</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="840" y="569.02">PiecePrivateKey</text><polygon fill="#181818" points="920,599.2188,930,603.2188,920,607.2188,924,603.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="617.5" x2="926" y1="603.2188" y2="603.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="624.5" y="598.1528">PieceUploadRequest</text><polygon fill="#181818" points="628.5,628.3516,618.5,632.3516,628.5,636.3516,624.5,632.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="622.5" x2="931" y1="632.3516" y2="632.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="634.5" y="627.2856">PieceUploadResponse</text><polygon fill="#181818" points="817.5,683.1836,827.5,687.1836,817.5,691.1836,821.5,687.1836" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="617.5" x2="823.5" y1="687.1836" y2="687.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="624.5" y="682.1177">SegmentCommitRequest</text><path d="M404,645.3516 L404,715.3516 L612,715.3516 L612,655.3516 L602,645.3516 L404,645.3516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M602,645.3516 L602,655.3516 L612,655.3516 L602,645.3516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="410" y="662.4185">SegmentID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="410" y="677.5513">EncryptedKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="410" y="692.6841">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="410" y="707.8169">[]SegmentPieceUploadResult</text><polygon fill="#181818" points="628.5,738.0156,618.5,742.0156,628.5,746.0156,624.5,742.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="622.5" x2="828.5" y1="742.0156" y2="742.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="634.5" y="736.9497">SegmentCommitResponse</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="394" x2="1000.5" y1="751.0156" y2="751.0156"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="59" x="399" y="761.2261">[if inline]</text><polygon fill="#181818" points="817.5,781.9531,827.5,785.9531,817.5,789.9531,821.5,785.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="617.5" x2="823.5" y1="785.9531" y2="785.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="624.5" y="780.8872">SegmentMakeInlineRequest</text><polygon fill="#181818" points="628.5,811.0859,618.5,815.0859,628.5,819.0859,624.5,815.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="622.5" x2="828.5" y1="815.0859" y2="815.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="634.5" y="810.02">SegmentMakeInlineResponse</text><polygon fill="#181818" points="451.5,847.2188,441.5,851.2188,451.5,855.2188,447.5,851.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="445.5" x2="616.5" y1="851.2188" y2="851.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="457.5" y="846.1528">UploadPart return</text><polygon fill="#181818" points="66.5,876.3516,56.5,880.3516,66.5,884.3516,62.5,880.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="60.5" x2="439.5" y1="880.3516" y2="880.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="72.5" y="875.2856">200 response</text><polygon fill="#181818" points="428.5,912.4844,438.5,916.4844,428.5,920.4844,432.5,916.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="55.5" x2="434.5" y1="916.4844" y2="916.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="62.5" y="911.4185">POST /bucket/dest?uploadId=7tKsLOJgNs</text><polygon fill="#181818" points="605.5,967.3164,615.5,971.3164,605.5,975.3164,609.5,971.3164" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="440.5" x2="611.5" y1="971.3164" y2="971.3164"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="447.5" y="966.2505">CommitUpload</text><path d="M303,929.4844 L303,999.4844 L435,999.4844 L435,939.4844 L425,929.4844 L303,929.4844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M425,929.4844 L425,939.4844 L435,939.4844 L425,929.4844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="309" y="946.5513">Bucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="309" y="961.6841">Key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="309" y="976.8169">UploadID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="309" y="991.9497">CustomMetadata</text><polygon fill="#181818" points="817.5,1043.2813,827.5,1047.2813,817.5,1051.2813,821.5,1047.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="617.5" x2="823.5" y1="1047.2813" y2="1047.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="624.5" y="1042.2153">ObjectCommitRequest</text><path d="M416,1010.0156 L416,1050.0156 L612,1050.0156 L612,1020.0156 L602,1010.0156 L416,1010.0156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M602,1010.0156 L602,1020.0156 L612,1020.0156 L602,1010.0156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="422" y="1027.0825">StreamID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="422" y="1042.2153">CustomMetadata</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="60" x="537" y="1042.2153">encypted</text><path d="M834,1010.0156 L834,1050.0156 L1029,1050.0156 L1029,1020.0156 L1019,1010.0156 L834,1010.0156 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M1019,1010.0156 L1019,1020.0156 L1029,1020.0156 L1019,1010.0156 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="840" y="1027.0825">Change object status from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="840" y="1042.2153">pending to committed</text><polygon fill="#181818" points="628.5,1072.4141,618.5,1076.4141,628.5,1080.4141,624.5,1076.4141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="622.5" x2="828.5" y1="1076.4141" y2="1076.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="634.5" y="1071.3481">ObjectCommitResponse</text><polygon fill="#181818" points="451.5,1101.5469,441.5,1105.5469,451.5,1109.5469,447.5,1105.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="445.5" x2="616.5" y1="1105.5469" y2="1105.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="457.5" y="1100.481">CommitUpload return</text><polygon fill="#181818" points="66.5,1130.6797,56.5,1134.6797,66.5,1138.6797,62.5,1134.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="60.5" x2="439.5" y1="1134.6797" y2="1134.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="72.5" y="1129.6138">200 response</text><!--MD5=[9d27879c9b00338d51b5cee8b900fef6]
@startuml

S3Client -> Gateway: PUT /bucket/dest?uploads

Gateway -> Uplink: BeginUpload (multipart)
note left
    Bucket
    Key
    Expires
end note

Uplink -> Satellite: BeginObjectRequest

Uplink <- - Satellite: BeginObjectResponse
note right
    StreamID
end note

Gateway <- - Uplink: BeginUpload return
note right
    StreamID
end note

S3Client <- - Gateway: 200 response
note right
    <UploadId />
end note

group loop for every part
    S3Client -> Gateway: PUT /bucket/dest?partNumber=1&uploadId=7tKsLOJgNs

    Gateway -> Uplink: UploadPart
    note left
        Bucket
        Key
        UploadID
        PartNumber
    end note

    Gateway -> Uplink: UploadPart.write

    group loop for every segment

        Uplink -> Satellite: SegmentBeginRequest
        note left
            StreamID
            Position
        end note

        Uplink <- - Satellite: SegmentBeginResponse
        note right
            SegmentID              
            OrderLimits
            PiecePrivateKey
        end note

        collections StorageNodes

        Uplink -> StorageNodes: PieceUploadRequest
        Uplink <- - StorageNodes: PieceUploadResponse

        Uplink -> Satellite: SegmentCommitRequest
        note left
            SegmentID
            EncryptedKey
            Size
            []SegmentPieceUploadResult
        end note

        Uplink <- - Satellite: SegmentCommitResponse

    else if inline
        Uplink -> Satellite: SegmentMakeInlineRequest
        Uplink <- - Satellite: SegmentMakeInlineResponse
    end

    Gateway <- - Uplink: UploadPart return

    S3Client <- - Gateway: 200 response
end

S3Client -> Gateway: POST /bucket/dest?uploadId=7tKsLOJgNs

Gateway -> Uplink: CommitUpload
note left
    Bucket
    Key
    UploadID
    CustomMetadata
end note

Uplink -> Satellite: ObjectCommitRequest
note left
    StreamID
    CustomMetadata //encypted//
end note
note right #lightgreen
    Change object status from 
    pending to committed
end note

Uplink <- - Satellite: ObjectCommitResponse

Gateway <- - Uplink: CommitUpload return

S3Client <- - Gateway: 200 response

@enduml

PlantUML version 1.2022.4(Sat Apr 09 15:29:17 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: IE
--></g></svg>