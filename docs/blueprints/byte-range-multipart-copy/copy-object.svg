<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="623px" preserveAspectRatio="none" style="width:815px;height:623px;background:#FFFFFF;" version="1.1" viewBox="0 0 815 623" width="815px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="40" x2="40" y1="36.2969" y2="588.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="289" x2="289" y1="36.2969" y2="588.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="429.5" x2="429.5" y1="36.2969" y2="588.6172"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="624.5" x2="624.5" y1="36.2969" y2="588.6172"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="12" y="24.9951">S3Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="5" y="587.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="12" y="607.6123">S3Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="253" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="260" y="24.9951">Gateway</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="253" y="587.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="260" y="607.6123">Gateway</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="401.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="408.5" y="24.9951">Uplink</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="401.5" y="587.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="408.5" y="607.6123">Uplink</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="590.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="597.5" y="24.9951">Satellite</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68" x="590.5" y="587.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="597.5" y="607.6123">Satellite</text><polygon fill="#181818" points="277.5,78.5625,287.5,82.5625,277.5,86.5625,281.5,82.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="40.5" x2="283.5" y1="82.5625" y2="82.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="47.5" y="62.3638">PUT /bucket/dest</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225" x="47.5" y="77.4966">x-amz-copy-source: /bucket/source</text><polygon fill="#181818" points="417.5,133.3945,427.5,137.3945,417.5,141.3945,421.5,137.3945" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="289.5" x2="423.5" y1="137.3945" y2="137.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="296.5" y="132.3286">CopyObject call</text><path d="M194,95.5625 L194,165.5625 L284,165.5625 L284,105.5625 L274,95.5625 L194,95.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M274,95.5625 L274,105.5625 L284,105.5625 L274,95.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="200" y="112.6294">oldBucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="200" y="127.7622">oldKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="200" y="142.895">newBucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="200" y="158.0278">newKey</text><polygon fill="#181818" points="612.5,213.9258,622.5,217.9258,612.5,221.9258,616.5,217.9258" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="429.5" x2="618.5" y1="217.9258" y2="217.9258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="436.5" y="212.8599">BeginCopyObjectRequest</text><path d="M243,176.0938 L243,246.0938 L424,246.0938 L424,186.0938 L414,176.0938 L243,176.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M414,176.0938 L414,186.0938 L424,186.0938 L414,176.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="249" y="193.1606">Bucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="249" y="208.2935">ObjectKey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="317" y="208.2935">encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="249" y="223.4263">NewBucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="249" y="238.5591">NewObjectKey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="344" y="238.5591">encrypted</text><polygon fill="#181818" points="440.5,286.8906,430.5,290.8906,440.5,294.8906,436.5,290.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="434.5" x2="623.5" y1="290.8906" y2="290.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="446.5" y="285.8247">BeginCopyObjectResponse</text><path d="M629,256.625 L629,311.625 L808,311.625 L808,266.625 L798,256.625 L629,256.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M798,256.625 L798,266.625 L808,266.625 L798,256.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="635" y="273.6919">StreamId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="635" y="288.8247">SegmentKeys</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="728" y="288.8247">encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="635" y="303.9575">MetadataKey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="723" y="303.9575">encrypted</text><polygon fill="#181818" points="612.5,390.1211,622.5,394.1211,612.5,398.1211,616.5,394.1211" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="429.5" x2="618.5" y1="394.1211" y2="394.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="436.5" y="389.0552">FinishCopyObjectRequest</text><path d="M206,322.0234 L206,453.0234 L424,453.0234 L424,332.0234 L414,322.0234 L206,322.0234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M414,322.0234 L414,332.0234 L424,332.0234 L414,322.0234 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="212" y="339.0903">StreamId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="212" y="354.2231">Bucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="212" y="369.356">ObjectKey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="280" y="369.356">encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="212" y="384.4888">NewBucket</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="212" y="399.6216">NewObjectKey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="307" y="399.6216">encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="212" y="414.7544">SegmentKeys</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="305" y="414.7544">encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="212" y="429.8872">MetadataKey</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="300" y="429.8872">encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="212" y="445.02">MetaData (optional)</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="344" y="445.02">encrypted</text><polygon fill="#181818" points="440.5,478.2188,430.5,482.2188,440.5,486.2188,436.5,482.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="434.5" x2="623.5" y1="482.2188" y2="482.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="446.5" y="477.1528">FinishCopyObjectResponse</text><path d="M629,463.0859 L629,488.0859 L760,488.0859 L760,473.0859 L750,463.0859 L629,463.0859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M750,463.0859 L750,473.0859 L760,473.0859 L750,463.0859 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="635" y="480.1528">Object</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="65" x="680" y="480.1528">encrypted</text><polygon fill="#181818" points="300.5,513.3516,290.5,517.3516,300.5,521.3516,296.5,517.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="294.5" x2="428.5" y1="517.3516" y2="517.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="306.5" y="512.2856">CopyObject return</text><path d="M434,498.2188 L434,523.2188 L496,523.2188 L496,508.2188 L486,498.2188 L434,498.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M486,498.2188 L486,508.2188 L496,508.2188 L486,498.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="440" y="515.2856">Object</text><polygon fill="#181818" points="51.5,556.0508,41.5,560.0508,51.5,564.0508,47.5,560.0508" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="45.5" x2="288.5" y1="560.0508" y2="560.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="57.5" y="554.9849">200 response</text><path d="M294,533.3516 L294,573.3516 L425,573.3516 L425,543.3516 L415,533.3516 L294,533.3516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M415,533.3516 L415,543.3516 L425,543.3516 L415,533.3516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="300" y="550.4185">&lt;ETag /&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="300" y="565.5513">&lt;LastModified /&gt;</text><!--MD5=[34244bb2171e436394822a94442c3d23]
@startuml
S3Client -> Gateway: PUT /bucket/dest\nx-amz-copy-source: /bucket/source
Gateway -> Uplink: CopyObject call
note left 
    oldBucket
    oldKey
    newBucket
    newKey
end note
Uplink -> Satellite: BeginCopyObjectRequest
note left 
    Bucket
    ObjectKey //encrypted//
    NewBucket
    NewObjectKey //encrypted//
end note
Uplink <- - Satellite: BeginCopyObjectResponse
note right 
    StreamId
    SegmentKeys //encrypted//
    MetadataKey //encrypted//
end note
Uplink -> Satellite: FinishCopyObjectRequest
note left 
    StreamId
    Bucket
    ObjectKey //encrypted//
    NewBucket
    NewObjectKey //encrypted//
    SegmentKeys //encrypted//
    MetadataKey //encrypted//
    MetaData (optional) //encrypted//
end note
Uplink <- - Satellite: FinishCopyObjectResponse
note right: Object //encrypted//

Gateway <- - Uplink: CopyObject return
note right: Object

S3Client <- - Gateway: 200 response
note right
<ETag />
<LastModified />
end note
@enduml

PlantUML version 1.2022.4(Sat Apr 09 15:29:17 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: IE
--></g></svg>